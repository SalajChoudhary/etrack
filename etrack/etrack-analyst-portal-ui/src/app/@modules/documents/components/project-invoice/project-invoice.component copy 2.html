<div class="bg-white modal_popup">
  <div class="top-header header-align">
    <div class="top-headings header-2n mb-3">Fees & Invoices</div>
  </div>
  <!-- <br />
<br />
<br /> -->
  <div class="col-10 offset-1 fees-invoice">
    <form [formGroup]="selectionForm" >
      <fieldset [disabled]="invoiceId">
      <div class="form-group row">
        <label for="" class="col-sm-5 pr-2 col-form-label text-right pr-0"
          >Freshwater Wetlands<sup>*</sup>:</label
        >
        <div class="col-sm-7 pl-0">
          <select class="form-control" formControlName="freshwater">
            <option value="">--Select--</option>
            <option
              *ngFor="let list of freshWaterprojectInvoiceList"
              [value]="list?.projectTypeCd"
            >
              {{ list?.projectType }} - ${{ list?.feeAmount }}
            </option>
          </select>
        </div>
      </div>

      <div class="form-group row">
        <label for="" class="col-sm-5 pr-2 col-form-label text-right pr-0"
          >Tidal Wetlands<sup>*</sup>:</label
        >
        <div class="col-sm-7 pl-0">
          <select class="form-control" formControlName="tidal">
            <option value="">--Select--</option>
            <option
              *ngFor="let list of projectInvoiceList"
              [value]="list?.projectTypeCd"
            >
              {{ list?.projectType }} - ${{ list?.feeAmount }}
            </option>
          </select>
        </div>
      </div>

      <div class="form-group row">
        <label
          for=""
          class="col-form-label col-sm-5 pr-2 pr-0 text-right fees_invoice_label"
          >Liquefield Natural Gas Facility<sup>*</sup>:</label
        >
        <div class="col-sm-7 pl-0">
          <select class="form-control" formControlName="lngf">
            <option value="">--Select--</option>
            <option
              *ngFor="let list of lngfprojectInvoiceList"
              [value]="list?.projectTypeCd"
            >
              {{ list?.projectType }} - ${{ list?.feeAmount }}
            </option>
          </select>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <div class="float-right">
            <h4 class="amount_paid">Amount Due: ${{ amountDue }}</h4>
          </div>
        </div>
      </div>
      <div><hr /></div>
      <div class="row">
        <div class="col-12">
          <div *ngIf="invoiceId">Invoice #: {{invoiceId}}</div>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <div class="d-flex justify-content-center align-items-center">
            <div class="d-flex justify-content-start align-items-start">
              <div class="mr-2 lh-25">
                <input type="checkbox" formControlName="paymentReceived" />
              </div>
              <div
                class="d-flex justify-content-start align-items-center flex-wrap lh-25"
              >
                <div class="mr-2">Payment received by check #</div>
                <div class="mr-2">
                  <input type="text" formControlName="checkNo" />
                </div>
                <div class="mr-2">On</div>
                <div class="mr-2">
                  <input
                    type="date"
                    class="form-input datepicker"
                    formControlName="date"
                  />
                </div>
                <div class="mr-2">for the amount of: $</div>
                <div class="mr-2">
                  <input type="text" formControlName="amount" />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row" *ngIf="!invoiceId">
        <div class="col-12">
          <div
            class="d-flex justify-content-start align-items-start flex-column"
          >
            <div
              *ngIf="selectionForm.get('checkNo')?.errors?.required"
              class="inv-error-msg"
            >
            {{errorMsgObj?.CHECK_NUM_REQD || 'Error: Check # is Required.'}}
              
            </div>
            <div
              *ngIf="selectionForm.get('checkNo')?.errors?.maxlength"
              class="inv-error-msg"
            >
              Error: Check # cannot exceed 10.
            </div>
            <div
              *ngIf="selectionForm.get('checkNo')?.errors?.pattern"
              class="inv-error-msg"
            >
              Error: Check # is Invalid.
            </div>
            <div
              *ngIf="selectionForm.get('amount')?.errors?.required"
              class="inv-error-msg"
            >
            {{errorMsgObj?.INV_AMOUNT_REQD|| 'Error: Amount is required.'}}
            </div>
            <div
              *ngIf="selectionForm.get('amount')?.errors?.pattern"
              class="inv-error-msg"
            >
            {{'Error: Amount is invalid.'}}
            </div>
            <div
              *ngIf="selectionForm.get('date')?.errors?.required"
              class="inv-error-msg"
            >
             {{errorMsgObj?.CHECK_DT_RCVD_REQD
              ||'Error: Date Received Required.'}}
            </div>
            <div
              *ngIf="
                !selectionForm.get('date')?.errors?.required &&
                !isSelectionFormCheckDateIsValid
              "
              class="inv-error-msg"
            >
             {{errorMsgObj?.DATE_RCVD_NOT_FUTURE ||'Error: Date cannot be greater than the Current Date.'}}
              
            </div>
          </div>
        </div>
      </div>
      <!--  -->
      <ng-container *ngIf="generateInvoice || invoiceId">
        <hr />
        <div class="row">
          <div class="col-12">
            <div class="d-flex justify-content-start align-items-start">
              <div class="mr-2 lh-25">
                <input type="checkbox" formControlName="reconciled"/>
              </div>
              <div
                class="d-flex justify-content-start align-items-start flex-wrap lh-25 flex-column"
              >
                <div>Payment reconciled in FIMS</div>
                <div class="d-flex justify-content-start align-items-start">
                    <div class="mr-2">Date Received On</div>
                    <div class="mr-2"><input type="date" class="form-input datepicker" formControlName="reconciledDate"></div>
                    <div class="mr-2">for the amount of: $ </div>
                    <div class="mr-2"><input type="text" formControlName="reconciledAmount"></div>
                  </div>
                  <div>
                    <div>Reference # <input type="text" formControlName="reconciledRef"/></div>
                  </div>
              </div>
            </div>
          </div>
        </div>
      </ng-container>
    </fieldset>
    </form>
  </div>

  <!-- <div class="shadow-div pt-0" *ngIf="isInvoiceSaved"></div> -->
  <!-- <br /> -->
  <!-- <div #printContent *ngIf="isInvoiceSaved">
    <div class="balance">
      <div class="invoice">
        <p>Invoice #: <span>{{ invoice.invoiceNum }}</span></p>
      </div>
      <div class="payment_details">
        <div class="payment_recived_date">
          <p>Payment Received Date: <span>12/12/2022</span></p>
        </div>
        <div class="payment_reference">
          <p>Pay Reference #: <span>123123</span></p>
        </div>
      </div>
      <p class="text-right "> Amount Paid: <span>${{ invoice.totalCharge }}</span></p>

    </div>
    <div class="shadow-div pt-0" *ngIf="canShowCancellationForm"></div>
    <div class="cancellation-form">
      
      <div class="form-label" *ngIf="canShowCancellationForm">Reason For Cancellation<sup>*</sup>:</div>
      <app-textarea-child *ngIf="canShowCancellationForm" [formGroup]="cancellationForm" fieldWidth="95%"
      controlName="reason"
     maxLength="5" noOfRows="4"></app-textarea-child>
    </div>

  </div> -->

  <div class="col-md-12 generate_invoice">
    <div class="text-center">
      <button
        type="button"
        *ngIf="!generateInvoice && !invoiceId"
        [disabled]="selectionForm.invalid || isInvoiceSaved"
        (click)="onGenerateInvoice()"
        class="btn btn-sm btn-primari nextbutton mb-2 mr-2 upload"
      >
        Generate Invoice
      </button>
      <!-- <button
        type="button"
        *ngIf="invoiceId"
        (click)="onCancelInvoice()"
        class="btn btn-sm btn-primari nextbutton mb-2 mr-2 upload"
      >
        Cancel Invoice
      </button> -->
      <!-- <button
        type="submit"
        [disabled]="selectionForm.invalid"
        (click)="onSave()"
        class="btn btn-sm btn-primari nextbutton mb-2 mr-2 upload"
      >
        Save
      </button> -->

      <!-- <button
    *ngIf="isInvoiceSaved"
    type="button"
    (click)="makePayment()"
    
    class="btn btn-sm btn-primari nextbutton mb-2 mr-2 upload"
    
  >
  Make Payment

    
  </button> -->
      <button
        type="button"
        class="btn btn-sm btn-outline-dark closebutton mb-2"
        (click)="onCancelClicked($event)"
      >
        Close
      </button>
      <!-- <button
      *ngIf="isInvoiceSaved"
      type="button"
      (click)="onPrint()"
      class="btn btn-sm btn-primari nextbutton mb-2 mr-2 upload"
    >
      Print
    </button> -->
    </div>
  </div>
</div>



<app-pending-changes-popup
  #pendingPopup
  (onOkClick)="onConfirmExit($event)"
></app-pending-changes-popup>